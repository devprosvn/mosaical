~/workspace/contracts$ npx hardhat test


  Mosaical MVP Test Suite
    Governance System
      ✔ Should create proposals
      ✔ Should handle voting process
    NFT Vault System
      ✔ Should deposit NFT and calculate correct LTV
      ✔ Should handle risk tier updates
      ✔ Should prevent unauthorized withdrawals
    Loan Manager System
      ✔ Should create loan with correct parameters
      ✔ Should calculate dynamic interest rates
      ✔ Should handle loan repayment correctly
    DPO Token System
      ✔ Should mint DPO tokens on loan creation
      ✔ Should handle DPO token trading
      1) Should distribute and claim interest
    Oracle System
      ✔ Should provide accurate NFT pricing
      ✔ Should track price history and volatility
      ✔ Should update game metrics
      Bridge System
        ✔ Should setup Saga chainlet mappings
        ✔ Should setup cross-chain mappings
        ✔ Should initiate NFT bridging to Saga chainlet
        ✔ Should initiate NFT bridging
      Security Tests
        ✔ Should prevent unauthorized access
        ✔ Should prevent borrowing without collateral
        ✔ Should prevent exceeding LTV limits
      Integration Tests
        ✔ Should validate devpros chainlet configuration
        2) Should complete full lending cycle


  21 passing (3s)
  2 failing

  1) Mosaical MVP Test Suite
       DPO Token System
         Should distribute and claim interest:
     Error: VM Exception while processing transaction: reverted with reason string 'Insufficient DPSV sent'
    at DPOTokenV3.mintOnLoan (contracts/DPOTokenV3.sol:52)
    at DPOTokenV3.distributeInterest (contracts/DPOTokenV3.sol:65)
    at EdrProviderWrapper.request (/home/runner/workspace/node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:359:41)
    at HardhatEthersSigner.sendTransaction (/home/runner/workspace/node_modules/@nomicfoundation/hardhat-ethers/src/signers.ts:181:18)
    at send (/home/runner/workspace/node_modules/ethers/src.ts/contract/contract.ts:313:20)
    at Proxy.distributeInterest (/home/runner/workspace/node_modules/ethers/src.ts/contract/contract.ts:352:16)
    at Context.<anonymous> (/home/runner/workspace/test/MosaicalMVP.test.js:356:7)
  

  2) Mosaical MVP Test Suite
       Oracle System
         Integration Tests
           Should complete full lending cycle:
     Error: VM Exception while processing transaction: reverted with reason string 'Insufficient DPSV sent'
    at DPOTokenV3.mintOnLoan (contracts/DPOTokenV3.sol:52)
    at DPOTokenV3.distributeInterest (contracts/DPOTokenV3.sol:65)
    at EdrProviderWrapper.request (/home/runner/workspace/node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:359:41)
    at HardhatEthersSigner.sendTransaction (/home/runner/workspace/node_modules/@nomicfoundation/hardhat-ethers/src/signers.ts:181:18)
    at send (/home/runner/workspace/node_modules/ethers/src.ts/contract/contract.ts:313:20)
    at Proxy.distributeInterest (/home/runner/workspace/node_modules/ethers/src.ts/contract/contract.ts:352:16)
    at Context.<anonymous> (/home/runner/workspace/test/MosaicalMVP.test.js:620:7)